<template>
  <div id="" class="boxextern">
    <div class=" boxintern text-center p-5">
      <button id="closeButtonCompanyDelete" class="closed" @click="closeModalDeleteCompany()">x</button>
      
      <svg width="80%" class="mb-3" viewBox="0 0 528 137" fill="none" xmlns="http://www.w3.org/2000/svg">
      <line x1="398" y1="118" x2="528" y2="118" stroke="white" stroke-width="2"/>
      <line y1="118" x2="130" y2="118" stroke="white" stroke-width="2"/>
      <path d="M154.552 130V108.672H160.572C162.428 108.672 164.068 109.082 165.494 109.902C166.92 110.723 168.019 111.89 168.79 113.403C169.571 114.917 169.967 116.655 169.977 118.618V119.98C169.977 121.992 169.586 123.755 168.805 125.269C168.033 126.782 166.925 127.944 165.479 128.755C164.044 129.565 162.369 129.98 160.455 130H154.552ZM157.364 110.986V127.7H160.323C162.491 127.7 164.176 127.026 165.377 125.679C166.588 124.331 167.193 122.412 167.193 119.922V118.677C167.193 116.255 166.622 114.375 165.479 113.037C164.347 111.689 162.735 111.006 160.646 110.986H157.364ZM180.392 130.293C178.243 130.293 176.495 129.59 175.147 128.184C173.8 126.768 173.126 124.878 173.126 122.515V122.017C173.126 120.444 173.424 119.043 174.02 117.812C174.625 116.572 175.465 115.605 176.539 114.912C177.623 114.209 178.795 113.857 180.055 113.857C182.115 113.857 183.717 114.536 184.859 115.894C186.002 117.251 186.573 119.194 186.573 121.724V122.852H175.836C175.875 124.414 176.329 125.679 177.198 126.646C178.077 127.603 179.19 128.081 180.538 128.081C181.495 128.081 182.306 127.886 182.97 127.495C183.634 127.104 184.215 126.587 184.713 125.942L186.368 127.231C185.04 129.272 183.048 130.293 180.392 130.293ZM180.055 116.084C178.961 116.084 178.043 116.484 177.301 117.285C176.559 118.076 176.1 119.189 175.924 120.625H183.863V120.42C183.785 119.043 183.414 117.979 182.75 117.227C182.086 116.465 181.188 116.084 180.055 116.084ZM192.667 130H189.957V107.5H192.667V130ZM203.595 130.293C201.446 130.293 199.698 129.59 198.351 128.184C197.003 126.768 196.329 124.878 196.329 122.515V122.017C196.329 120.444 196.627 119.043 197.223 117.812C197.828 116.572 198.668 115.605 199.742 114.912C200.826 114.209 201.998 113.857 203.258 113.857C205.318 113.857 206.92 114.536 208.062 115.894C209.205 117.251 209.776 119.194 209.776 121.724V122.852H199.039C199.078 124.414 199.532 125.679 200.401 126.646C201.28 127.603 202.394 128.081 203.741 128.081C204.698 128.081 205.509 127.886 206.173 127.495C206.837 127.104 207.418 126.587 207.916 125.942L209.571 127.231C208.243 129.272 206.251 130.293 203.595 130.293ZM203.258 116.084C202.164 116.084 201.246 116.484 200.504 117.285C199.762 118.076 199.303 119.189 199.127 120.625H207.066V120.42C206.988 119.043 206.617 117.979 205.953 117.227C205.289 116.465 204.391 116.084 203.258 116.084ZM216.603 110.312V114.15H219.562V116.245H216.603V126.074C216.603 126.709 216.734 127.188 216.998 127.51C217.262 127.822 217.711 127.979 218.346 127.979C218.658 127.979 219.088 127.92 219.635 127.803V130C218.922 130.195 218.229 130.293 217.555 130.293C216.344 130.293 215.431 129.927 214.815 129.194C214.2 128.462 213.893 127.422 213.893 126.074V116.245H211.007V114.15H213.893V110.312H216.603ZM229.317 130.293C227.169 130.293 225.421 129.59 224.073 128.184C222.726 126.768 222.052 124.878 222.052 122.515V122.017C222.052 120.444 222.35 119.043 222.945 117.812C223.551 116.572 224.391 115.605 225.465 114.912C226.549 114.209 227.721 113.857 228.98 113.857C231.041 113.857 232.643 114.536 233.785 115.894C234.928 117.251 235.499 119.194 235.499 121.724V122.852H224.762C224.801 124.414 225.255 125.679 226.124 126.646C227.003 127.603 228.116 128.081 229.464 128.081C230.421 128.081 231.231 127.886 231.896 127.495C232.56 127.104 233.141 126.587 233.639 125.942L235.294 127.231C233.966 129.272 231.974 130.293 229.317 130.293ZM228.98 116.084C227.887 116.084 226.969 116.484 226.227 117.285C225.484 118.076 225.025 119.189 224.85 120.625H232.789V120.42C232.711 119.043 232.34 117.979 231.676 117.227C231.012 116.465 230.113 116.084 228.98 116.084ZM262.203 123.232C261.939 125.488 261.104 127.231 259.698 128.462C258.302 129.683 256.441 130.293 254.117 130.293C251.598 130.293 249.576 129.39 248.053 127.583C246.539 125.776 245.782 123.359 245.782 120.332V118.281C245.782 116.299 246.134 114.556 246.837 113.052C247.55 111.548 248.556 110.396 249.854 109.595C251.153 108.784 252.657 108.379 254.366 108.379C256.632 108.379 258.448 109.014 259.815 110.283C261.183 111.543 261.979 113.291 262.203 115.527H259.376C259.132 113.828 258.6 112.598 257.779 111.836C256.969 111.074 255.831 110.693 254.366 110.693C252.569 110.693 251.158 111.357 250.133 112.686C249.117 114.014 248.609 115.903 248.609 118.354V120.42C248.609 122.734 249.093 124.575 250.06 125.942C251.026 127.31 252.379 127.993 254.117 127.993C255.68 127.993 256.876 127.642 257.706 126.938C258.546 126.226 259.103 124.99 259.376 123.232H262.203ZM264.913 121.929C264.913 120.376 265.216 118.979 265.821 117.739C266.437 116.499 267.286 115.542 268.37 114.868C269.464 114.194 270.709 113.857 272.105 113.857C274.264 113.857 276.007 114.604 277.335 116.099C278.673 117.593 279.342 119.58 279.342 122.061V122.251C279.342 123.794 279.044 125.181 278.448 126.411C277.862 127.632 277.018 128.584 275.914 129.268C274.82 129.951 273.561 130.293 272.135 130.293C269.986 130.293 268.243 129.546 266.905 128.052C265.577 126.558 264.913 124.58 264.913 122.119V121.929ZM267.638 122.251C267.638 124.009 268.043 125.42 268.854 126.484C269.674 127.549 270.768 128.081 272.135 128.081C273.512 128.081 274.605 127.544 275.416 126.47C276.227 125.386 276.632 123.872 276.632 121.929C276.632 120.19 276.217 118.784 275.387 117.71C274.566 116.626 273.473 116.084 272.105 116.084C270.768 116.084 269.688 116.616 268.868 117.681C268.048 118.745 267.638 120.269 267.638 122.251ZM285.289 114.15L285.362 115.908C286.524 114.541 288.092 113.857 290.064 113.857C292.281 113.857 293.79 114.707 294.591 116.406C295.118 115.645 295.802 115.029 296.642 114.561C297.491 114.092 298.492 113.857 299.645 113.857C303.121 113.857 304.889 115.698 304.947 119.38V130H302.237V119.541C302.237 118.408 301.979 117.563 301.461 117.007C300.943 116.44 300.074 116.157 298.854 116.157C297.848 116.157 297.013 116.46 296.349 117.065C295.685 117.661 295.299 118.467 295.191 119.482V130H292.467V119.614C292.467 117.31 291.339 116.157 289.083 116.157C287.306 116.157 286.09 116.914 285.436 118.428V130H282.726V114.15H285.289ZM322.438 122.251C322.438 124.663 321.886 126.606 320.782 128.081C319.679 129.556 318.185 130.293 316.3 130.293C314.376 130.293 312.862 129.683 311.759 128.462V136.094H309.049V114.15H311.524L311.656 115.908C312.76 114.541 314.293 113.857 316.256 113.857C318.16 113.857 319.664 114.575 320.768 116.011C321.881 117.446 322.438 119.443 322.438 122.002V122.251ZM319.728 121.943C319.728 120.156 319.347 118.745 318.585 117.71C317.823 116.675 316.778 116.157 315.45 116.157C313.81 116.157 312.579 116.885 311.759 118.34V125.913C312.569 127.358 313.81 128.081 315.479 128.081C316.778 128.081 317.809 127.568 318.57 126.543C319.342 125.508 319.728 123.975 319.728 121.943ZM335.68 130C335.523 129.688 335.396 129.131 335.299 128.33C334.039 129.639 332.535 130.293 330.787 130.293C329.225 130.293 327.94 129.854 326.935 128.975C325.938 128.086 325.44 126.963 325.44 125.605C325.44 123.955 326.065 122.676 327.315 121.768C328.575 120.85 330.343 120.391 332.618 120.391H335.255V119.146C335.255 118.198 334.972 117.446 334.405 116.89C333.839 116.323 333.004 116.04 331.9 116.04C330.934 116.04 330.123 116.284 329.469 116.772C328.814 117.261 328.487 117.852 328.487 118.545H325.763C325.763 117.754 326.041 116.992 326.598 116.26C327.164 115.518 327.926 114.932 328.883 114.502C329.85 114.072 330.909 113.857 332.062 113.857C333.888 113.857 335.318 114.316 336.354 115.234C337.389 116.143 337.926 117.397 337.965 118.999V126.294C337.965 127.749 338.15 128.906 338.521 129.766V130H335.68ZM331.183 127.935C332.032 127.935 332.838 127.715 333.6 127.275C334.361 126.836 334.913 126.265 335.255 125.562V122.31H333.131C329.811 122.31 328.15 123.281 328.15 125.225C328.15 126.074 328.434 126.738 329 127.217C329.566 127.695 330.294 127.935 331.183 127.935ZM344.776 114.15L344.864 116.143C346.075 114.619 347.657 113.857 349.61 113.857C352.96 113.857 354.649 115.747 354.679 119.526V130H351.969V119.512C351.959 118.369 351.695 117.524 351.178 116.978C350.67 116.431 349.874 116.157 348.79 116.157C347.911 116.157 347.14 116.392 346.476 116.86C345.812 117.329 345.294 117.944 344.923 118.706V130H342.213V114.15H344.776ZM363.951 126.03L367.643 114.15H370.543L364.171 132.446C363.185 135.083 361.617 136.401 359.469 136.401L358.956 136.357L357.945 136.167V133.97L358.678 134.028C359.596 134.028 360.309 133.843 360.816 133.472C361.334 133.101 361.759 132.422 362.091 131.436L362.691 129.824L357.037 114.15H359.996L363.951 126.03Z" fill="white"/>
      <circle cx="261" cy="52" r="51" stroke="white" stroke-width="2"/>
      <path d="M276 60.3333H271V65.8889H276V60.3333ZM276 49.2222H271V54.7778H276V49.2222ZM281 71.4444H261V65.8889H266V60.3333H261V54.7778H266V49.2222H261V43.6667H281V71.4444ZM256 38.1111H251V32.5556H256V38.1111ZM256 49.2222H251V43.6667H256V49.2222ZM256 60.3333H251V54.7778H256V60.3333ZM256 71.4444H251V65.8889H256V71.4444ZM246 38.1111H241V32.5556H246V38.1111ZM246 49.2222H241V43.6667H246V49.2222ZM246 60.3333H241V54.7778H246V60.3333ZM246 71.4444H241V65.8889H246V71.4444ZM261 38.1111V27H236V77H286V38.1111H261Z" fill="white"/>
      </svg>

      
      <div id="companyOptions" class="p-3 form-input d-flex flex-column align-items-start m-auto rounded" style="width: 60%;height: 30vh;">
      </div>
      <b-button id="buttonDeleteCompanyModal" class="mt-3" block variant="outline-warning">Delete</b-button>
    </div>
  </div>
</template>

<script>
import { CompanyService } from "../service/compiled/company/CompanyService"
let companyService = new CompanyService();
var pageNumberCompanys = 0;
  export default{
    methods:{
      closeModalDeleteCompany(){
        this.$emit('click');
      },

      setCompaniesOnVue() {
            let element = document.getElementById("companyOptions");
            let html = element.innerHTML;
            fetch(`http://localhost:8080/api/company/find-all/`, {
                method: 'GET',
                headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                "Authorization": `Bearer ${window.localStorage.getItem("token")}`
                }
            }).then(async function(apiResponse) {
                let json = await apiResponse.json();
                let count = 0;
                while (json[count] !== undefined) {
                    html = html + `<span><input type="checkbox" value="${json[count]["id"]}" id="companyCheckedBoxDelete"> ${json[count]["name"]}</span>`
                    count++;
                }
                element.innerHTML = html;
            });
        },

         companyScrollPage() {
            let companyOp = document.getElementById("companyOptions");
            companyOp.addEventListener("scroll", () => {
                if(companyOp.scrollTop + companyOp.clientHeight == companyOp.scrollHeight) {
                    pageNumberCompanys++;
                    this.setCompaniesOnVue(pageNumberCompanys);
                }
            })
        }
    },
    
    mounted() {
        this.setCompaniesOnVue(0);
        this.companyScrollPage();
        companyService.deleteCompanyListener()
    }
  };
</script>

<style scoped>

.font-red {
  color: red;
}

.form-input {
  color: white;
  border: 1px solid white;
}

.boxextern {
  width: 100vw;
  height: 100vh; 
  background: rgba(0, 0, 0,.5);
  position: fixed;
  top: 0px;
  left: 0px;
  z-index: 2000;
  display: flex;
  justify-content: center;
  align-items: center;
}

.boxintern {
  background: linear-gradient(138.08deg, #531A7B -13.53%, rgba(110, 38, 161, 0.66) 54.75%, rgba(149, 57, 213, 0.46) 111.81%, rgba(161, 60, 232, 0) 165.13%), #FFFFFF;;
  width: 40%;
  min-width: 300px;
  max-height: 500px;
  padding: 20px;
  border-radius: 8px;
  position: relative;
}

.closed {
  background: transparent;
  position: absolute;
  top: 0px;
  right: 0px;
  width: 50px;
  height: 50px;
  border: none;
  cursor: pointer;
  font-size: 1.4em;
}

.divider-menu {
    border: 1px solid rgb(255, 255, 255);
    width: 100%;
}

#CategoryOptions{
  overflow-x: hidden;
  overflow-y: auto;
}

</style>