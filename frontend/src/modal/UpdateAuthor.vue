<template>
  <div id="" class="boxextern">
    <div class=" boxintern text-center p-5">
      <button id="closeButtonAuthorUpdate" class="closed" @click="closeModalUpdateAuthor()">x</button>
      <svg width="70%" viewBox="0 0 481 137" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="351" y1="120" x2="481" y2="120" stroke="white" stroke-width="2"/><line y1="118" x2="130" y2="118" stroke="white" stroke-width="2"/>
      <path d="M159.853 108.672V123.174C159.843 125.186 159.208 126.831 157.948 128.11C156.698 129.39 154.999 130.107 152.851 130.264L152.104 130.293C149.77 130.293 147.909 129.663 146.522 128.403C145.136 127.144 144.433 125.41 144.413 123.203V108.672H147.196V123.115C147.196 124.658 147.621 125.859 148.471 126.719C149.32 127.568 150.531 127.993 152.104 127.993C153.695 127.993 154.911 127.568 155.751 126.719C156.601 125.869 157.025 124.673 157.025 123.13V108.672H159.853ZM177.255 122.251C177.255 124.663 176.703 126.606 175.6 128.081C174.496 129.556 173.002 130.293 171.117 130.293C169.193 130.293 167.68 129.683 166.576 128.462V136.094H163.866V114.15H166.342L166.474 115.908C167.577 114.541 169.11 113.857 171.073 113.857C172.978 113.857 174.481 114.575 175.585 116.011C176.698 117.446 177.255 119.443 177.255 122.002V122.251ZM174.545 121.943C174.545 120.156 174.164 118.745 173.402 117.71C172.641 116.675 171.596 116.157 170.268 116.157C168.627 116.157 167.396 116.885 166.576 118.34V125.913C167.387 127.358 168.627 128.081 170.297 128.081C171.596 128.081 172.626 127.568 173.388 126.543C174.159 125.508 174.545 123.975 174.545 121.943ZM180.053 121.943C180.053 119.512 180.629 117.559 181.781 116.084C182.934 114.6 184.442 113.857 186.308 113.857C188.163 113.857 189.633 114.492 190.717 115.762V107.5H193.427V130H190.937L190.805 128.301C189.721 129.629 188.212 130.293 186.278 130.293C184.442 130.293 182.943 129.541 181.781 128.037C180.629 126.533 180.053 124.57 180.053 122.148V121.943ZM182.763 122.251C182.763 124.048 183.134 125.454 183.876 126.47C184.618 127.485 185.644 127.993 186.952 127.993C188.671 127.993 189.926 127.222 190.717 125.679V118.398C189.906 116.904 188.661 116.157 186.981 116.157C185.653 116.157 184.618 116.67 183.876 117.695C183.134 118.721 182.763 120.239 182.763 122.251ZM207.431 130C207.274 129.688 207.147 129.131 207.05 128.33C205.79 129.639 204.286 130.293 202.538 130.293C200.976 130.293 199.691 129.854 198.686 128.975C197.689 128.086 197.191 126.963 197.191 125.605C197.191 123.955 197.816 122.676 199.066 121.768C200.326 120.85 202.094 120.391 204.369 120.391H207.006V119.146C207.006 118.198 206.723 117.446 206.156 116.89C205.59 116.323 204.755 116.04 203.651 116.04C202.685 116.04 201.874 116.284 201.22 116.772C200.565 117.261 200.238 117.852 200.238 118.545H197.514C197.514 117.754 197.792 116.992 198.349 116.26C198.915 115.518 199.677 114.932 200.634 114.502C201.601 114.072 202.66 113.857 203.812 113.857C205.639 113.857 207.069 114.316 208.104 115.234C209.14 116.143 209.677 117.397 209.716 118.999V126.294C209.716 127.749 209.901 128.906 210.272 129.766V130H207.431ZM202.934 127.935C203.783 127.935 204.589 127.715 205.351 127.275C206.112 126.836 206.664 126.265 207.006 125.562V122.31H204.882C201.562 122.31 199.901 123.281 199.901 125.225C199.901 126.074 200.185 126.738 200.751 127.217C201.317 127.695 202.045 127.935 202.934 127.935ZM217.641 110.312V114.15H220.6V116.245H217.641V126.074C217.641 126.709 217.772 127.188 218.036 127.51C218.3 127.822 218.749 127.979 219.384 127.979C219.696 127.979 220.126 127.92 220.673 127.803V130C219.96 130.195 219.267 130.293 218.593 130.293C217.382 130.293 216.469 129.927 215.854 129.194C215.238 128.462 214.931 127.422 214.931 126.074V116.245H212.045V114.15H214.931V110.312H217.641ZM230.355 130.293C228.207 130.293 226.459 129.59 225.111 128.184C223.764 126.768 223.09 124.878 223.09 122.515V122.017C223.09 120.444 223.388 119.043 223.983 117.812C224.589 116.572 225.429 115.605 226.503 114.912C227.587 114.209 228.759 113.857 230.019 113.857C232.079 113.857 233.681 114.536 234.823 115.894C235.966 117.251 236.537 119.194 236.537 121.724V122.852H225.8C225.839 124.414 226.293 125.679 227.162 126.646C228.041 127.603 229.154 128.081 230.502 128.081C231.459 128.081 232.27 127.886 232.934 127.495C233.598 127.104 234.179 126.587 234.677 125.942L236.332 127.231C235.004 129.272 233.012 130.293 230.355 130.293ZM230.019 116.084C228.925 116.084 228.007 116.484 227.265 117.285C226.522 118.076 226.063 119.189 225.888 120.625H233.827V120.42C233.749 119.043 233.378 117.979 232.714 117.227C232.05 116.465 231.151 116.084 230.019 116.084ZM259.33 124.434H250.395L248.388 130H245.487L253.632 108.672H256.093L264.252 130H261.366L259.33 124.434ZM251.244 122.119H258.495L254.862 112.144L251.244 122.119ZM276.308 128.433C275.253 129.673 273.705 130.293 271.664 130.293C269.975 130.293 268.686 129.805 267.797 128.828C266.918 127.842 266.474 126.387 266.464 124.463V114.15H269.174V124.39C269.174 126.792 270.15 127.993 272.104 127.993C274.174 127.993 275.551 127.222 276.234 125.679V114.15H278.944V130H276.366L276.308 128.433ZM286.752 110.312V114.15H289.711V116.245H286.752V126.074C286.752 126.709 286.884 127.188 287.147 127.51C287.411 127.822 287.86 127.979 288.495 127.979C288.808 127.979 289.237 127.92 289.784 127.803V130C289.071 130.195 288.378 130.293 287.704 130.293C286.493 130.293 285.58 129.927 284.965 129.194C284.35 128.462 284.042 127.422 284.042 126.074V116.245H281.156V114.15H284.042V110.312H286.752ZM295.6 116.069C296.801 114.595 298.363 113.857 300.287 113.857C303.637 113.857 305.326 115.747 305.355 119.526V130H302.646V119.512C302.636 118.369 302.372 117.524 301.854 116.978C301.347 116.431 300.551 116.157 299.467 116.157C298.588 116.157 297.816 116.392 297.152 116.86C296.488 117.329 295.971 117.944 295.6 118.706V130H292.89V107.5H295.6V116.069ZM308.695 121.929C308.695 120.376 308.998 118.979 309.604 117.739C310.219 116.499 311.068 115.542 312.152 114.868C313.246 114.194 314.491 113.857 315.888 113.857C318.046 113.857 319.789 114.604 321.117 116.099C322.455 117.593 323.124 119.58 323.124 122.061V122.251C323.124 123.794 322.826 125.181 322.23 126.411C321.645 127.632 320.8 128.584 319.696 129.268C318.603 129.951 317.343 130.293 315.917 130.293C313.769 130.293 312.025 129.546 310.688 128.052C309.359 126.558 308.695 124.58 308.695 122.119V121.929ZM311.42 122.251C311.42 124.009 311.825 125.42 312.636 126.484C313.456 127.549 314.55 128.081 315.917 128.081C317.294 128.081 318.388 127.544 319.198 126.47C320.009 125.386 320.414 123.872 320.414 121.929C320.414 120.19 319.999 118.784 319.169 117.71C318.349 116.626 317.255 116.084 315.888 116.084C314.55 116.084 313.471 116.616 312.65 117.681C311.83 118.745 311.42 120.269 311.42 122.251ZM334.184 116.582C333.773 116.514 333.329 116.479 332.851 116.479C331.073 116.479 329.867 117.236 329.232 118.75V130H326.522V114.15H329.159L329.203 115.981C330.092 114.565 331.352 113.857 332.982 113.857C333.51 113.857 333.91 113.926 334.184 114.062V116.582Z" fill="white"/><circle cx="238" cy="52" r="51" stroke="white" stroke-width="2"/>
      <g clip-path="url(#clip0_93_161)"><path d="M205 84V85H206H271H272V84V76C272 72.9667 270.449 70.3877 268.12 68.2712C265.797 66.1603 262.629 64.4385 259.185 63.0798C252.296 60.3627 244.046 59 238.5 59C232.954 59 224.704 60.3627 217.815 63.0798C214.371 64.4385 211.203 66.1603 208.88 68.2712C206.551 70.3877 205 72.9667 205 76V84ZM238.5 53C248.016 53 255.75 45.4068 255.75 36C255.75 26.5932 248.016 19 238.5 19C228.984 19 221.25 26.5932 221.25 36C221.25 45.4068 228.984 53 238.5 53Z" stroke="white" stroke-width="2"/></g>
      <defs>
      <clipPath id="clip0_93_161">
      <rect x="193" y="7" width="91" height="77" fill="white"/>
      </clipPath>
      </defs>
      </svg>
      
      <select id="authorSelectOptions" class="mt-4 p-2 form-input" style="width: 55%">
      </select>
      <input type="text" id="newNameAuthor" class="mt-4 p-2 form-input" style="width: 55%" placeholder="New Name">
      <b-button id="buttonUpdateAuthorModal" class="mt-3" block variant="outline-warning">Update</b-button>
    </div>
    
  </div>
</template>

<script>
import { AuthorService } from "../service/compiled/author/AuthorService";
let authorService = new AuthorService();
var pageNumberAuthor = 0;
  export default{
    methods:{
      closeModalUpdateAuthor(){
        this.$emit('click');
      },

       setAuthorOnVue(pageNumber) {
            let element = document.getElementById("authorSelectOptions");
            let html = element.innerHTML;
            fetch(`http://localhost:8080/api/author/find/find-all/${pageNumber}`, {
                method: 'GET',
                headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                "Authorization": `Bearer ${window.localStorage.getItem("token")}`
                }
            }).then(async function(apiResponse) {
                let json = await apiResponse.json();
                let count = 0;
                while (json[count] !== undefined) {
                    html = html + `<option  value="${json[count]["id"]}" id="authorSelect"> ${json[count]["name"]}</option>`
                    count++;
                }
                element.innerHTML = html;
            });
        },
        authorScrollPage() {
            let authorOp = document.getElementById("authorSelectOptions");
            authorOp.addEventListener("scroll", () => {
                if(authorOp.scrollTop + authorOp.clientHeight == authorOp.scrollHeight) {
                    pageNumberAuthor++;
                    this.setAuthorOnVue(pageNumberAuthor);
                }
            })
        }
    },

    mounted() {
      this.setAuthorOnVue(0);
      this.authorScrollPage();
      authorService.updateAuthorListener();
    },
  };
</script>

<style scoped>

.font-red {
  color: red;
}

.form-input {
  color: white;
  background: #9539D5;
  border: none;
}
.form-input::placeholder {
  color: white;
}
.form-input:focus {
  color: white;
  background: #9539D5;
  outline: none;
}

.boxextern {
  width: 100vw;
  height: 100vh; 
  background: rgba(0, 0, 0,.5);
  position: fixed;
  top: 0px;
  left: 0px;
  z-index: 2000;
  display: flex;
  justify-content: center;
  align-items: center;
}

.boxintern {
  background: linear-gradient(138.08deg, #531A7B -13.53%, rgba(110, 38, 161, 0.66) 54.75%, rgba(149, 57, 213, 0.46) 111.81%, rgba(161, 60, 232, 0) 165.13%), #FFFFFF;;
  width: 40%;
  min-width: 300px;
  max-height: 500px;
  padding: 20px;
  border-radius: 8px;
  position: relative;
}

.closed {
  background: transparent;
  position: absolute;
  top: 0px;
  right: 0px;
  width: 50px;
  height: 50px;
  border: none;
  cursor: pointer;
  font-size: 1.4em;
}

.divider-menu {
    border: 1px solid rgb(255, 255, 255);
    width: 100%;
}

</style>