<template>
  <div id="" class="boxextern">
    <div class=" boxintern text-center p-5">
        <button id="closeButtonProductDelete" class="closed" @click="closeModalDeleteProduct()">x</button>

        <svg width="70%" class="mb-3" viewBox="0 0 528 137" fill="none" xmlns="http://www.w3.org/2000/svg">
        <line x1="398" y1="118" x2="528" y2="118" stroke="white" stroke-width="2"/>
        <line y1="118" x2="130" y2="118" stroke="white" stroke-width="2"/>
        <path d="M165.538 130V108.672H171.559C173.414 108.672 175.055 109.082 176.48 109.902C177.906 110.723 179.005 111.89 179.776 113.403C180.558 114.917 180.953 116.655 180.963 118.618V119.98C180.963 121.992 180.572 123.755 179.791 125.269C179.02 126.782 177.911 127.944 176.466 128.755C175.03 129.565 173.355 129.98 171.441 130H165.538ZM168.351 110.986V127.7H171.31C173.478 127.7 175.162 127.026 176.363 125.679C177.574 124.331 178.18 122.412 178.18 119.922V118.677C178.18 116.255 177.608 114.375 176.466 113.037C175.333 111.689 173.722 111.006 171.632 110.986H168.351ZM191.378 130.293C189.229 130.293 187.481 129.59 186.134 128.184C184.786 126.768 184.112 124.878 184.112 122.515V122.017C184.112 120.444 184.41 119.043 185.006 117.812C185.611 116.572 186.451 115.605 187.525 114.912C188.609 114.209 189.781 113.857 191.041 113.857C193.102 113.857 194.703 114.536 195.846 115.894C196.988 117.251 197.56 119.194 197.56 121.724V122.852H186.822C186.861 124.414 187.315 125.679 188.185 126.646C189.063 127.603 190.177 128.081 191.524 128.081C192.481 128.081 193.292 127.886 193.956 127.495C194.62 127.104 195.201 126.587 195.699 125.942L197.354 127.231C196.026 129.272 194.034 130.293 191.378 130.293ZM191.041 116.084C189.947 116.084 189.029 116.484 188.287 117.285C187.545 118.076 187.086 119.189 186.91 120.625H194.85V120.42C194.771 119.043 194.4 117.979 193.736 117.227C193.072 116.465 192.174 116.084 191.041 116.084ZM203.653 130H200.943V107.5H203.653V130ZM214.581 130.293C212.433 130.293 210.685 129.59 209.337 128.184C207.989 126.768 207.315 124.878 207.315 122.515V122.017C207.315 120.444 207.613 119.043 208.209 117.812C208.814 116.572 209.654 115.605 210.729 114.912C211.812 114.209 212.984 113.857 214.244 113.857C216.305 113.857 217.906 114.536 219.049 115.894C220.191 117.251 220.763 119.194 220.763 121.724V122.852H210.025C210.064 124.414 210.519 125.679 211.388 126.646C212.267 127.603 213.38 128.081 214.728 128.081C215.685 128.081 216.495 127.886 217.159 127.495C217.823 127.104 218.404 126.587 218.902 125.942L220.558 127.231C219.229 129.272 217.237 130.293 214.581 130.293ZM214.244 116.084C213.15 116.084 212.232 116.484 211.49 117.285C210.748 118.076 210.289 119.189 210.113 120.625H218.053V120.42C217.975 119.043 217.604 117.979 216.939 117.227C216.275 116.465 215.377 116.084 214.244 116.084ZM227.589 110.312V114.15H230.548V116.245H227.589V126.074C227.589 126.709 227.721 127.188 227.984 127.51C228.248 127.822 228.697 127.979 229.332 127.979C229.645 127.979 230.074 127.92 230.621 127.803V130C229.908 130.195 229.215 130.293 228.541 130.293C227.33 130.293 226.417 129.927 225.802 129.194C225.187 128.462 224.879 127.422 224.879 126.074V116.245H221.993V114.15H224.879V110.312H227.589ZM240.304 130.293C238.155 130.293 236.407 129.59 235.06 128.184C233.712 126.768 233.038 124.878 233.038 122.515V122.017C233.038 120.444 233.336 119.043 233.932 117.812C234.537 116.572 235.377 115.605 236.451 114.912C237.535 114.209 238.707 113.857 239.967 113.857C242.027 113.857 243.629 114.536 244.771 115.894C245.914 117.251 246.485 119.194 246.485 121.724V122.852H235.748C235.787 124.414 236.241 125.679 237.11 126.646C237.989 127.603 239.103 128.081 240.45 128.081C241.407 128.081 242.218 127.886 242.882 127.495C243.546 127.104 244.127 126.587 244.625 125.942L246.28 127.231C244.952 129.272 242.96 130.293 240.304 130.293ZM239.967 116.084C238.873 116.084 237.955 116.484 237.213 117.285C236.471 118.076 236.012 119.189 235.836 120.625H243.775V120.42C243.697 119.043 243.326 117.979 242.662 117.227C241.998 116.465 241.1 116.084 239.967 116.084ZM260.313 121.65V130H257.501V108.672H265.367C267.701 108.672 269.527 109.268 270.846 110.459C272.174 111.65 272.838 113.228 272.838 115.19C272.838 117.261 272.188 118.857 270.89 119.98C269.601 121.094 267.75 121.65 265.338 121.65H260.313ZM260.313 119.351H265.367C266.871 119.351 268.023 118.999 268.824 118.296C269.625 117.583 270.025 116.558 270.025 115.22C270.025 113.95 269.625 112.935 268.824 112.173C268.023 111.411 266.925 111.016 265.528 110.986H260.313V119.351ZM283.663 116.582C283.253 116.514 282.809 116.479 282.33 116.479C280.553 116.479 279.347 117.236 278.712 118.75V130H276.002V114.15H278.639L278.683 115.981C279.571 114.565 280.831 113.857 282.462 113.857C282.989 113.857 283.39 113.926 283.663 114.062V116.582ZM285.157 121.929C285.157 120.376 285.46 118.979 286.065 117.739C286.681 116.499 287.53 115.542 288.614 114.868C289.708 114.194 290.953 113.857 292.35 113.857C294.508 113.857 296.251 114.604 297.579 116.099C298.917 117.593 299.586 119.58 299.586 122.061V122.251C299.586 123.794 299.288 125.181 298.692 126.411C298.106 127.632 297.262 128.584 296.158 129.268C295.064 129.951 293.805 130.293 292.379 130.293C290.23 130.293 288.487 129.546 287.149 128.052C285.821 126.558 285.157 124.58 285.157 122.119V121.929ZM287.882 122.251C287.882 124.009 288.287 125.42 289.098 126.484C289.918 127.549 291.012 128.081 292.379 128.081C293.756 128.081 294.85 127.544 295.66 126.47C296.471 125.386 296.876 123.872 296.876 121.929C296.876 120.19 296.461 118.784 295.631 117.71C294.811 116.626 293.717 116.084 292.35 116.084C291.012 116.084 289.933 116.616 289.112 117.681C288.292 118.745 287.882 120.269 287.882 122.251ZM302.325 121.943C302.325 119.512 302.901 117.559 304.054 116.084C305.206 114.6 306.715 113.857 308.58 113.857C310.436 113.857 311.905 114.492 312.989 115.762V107.5H315.699V130H313.209L313.077 128.301C311.993 129.629 310.484 130.293 308.551 130.293C306.715 130.293 305.216 129.541 304.054 128.037C302.901 126.533 302.325 124.57 302.325 122.148V121.943ZM305.035 122.251C305.035 124.048 305.406 125.454 306.148 126.47C306.891 127.485 307.916 127.993 309.225 127.993C310.943 127.993 312.198 127.222 312.989 125.679V118.398C312.179 116.904 310.934 116.157 309.254 116.157C307.926 116.157 306.891 116.67 306.148 117.695C305.406 118.721 305.035 120.239 305.035 122.251ZM329.703 128.433C328.648 129.673 327.101 130.293 325.06 130.293C323.37 130.293 322.081 129.805 321.192 128.828C320.313 127.842 319.869 126.387 319.859 124.463V114.15H322.569V124.39C322.569 126.792 323.546 127.993 325.499 127.993C327.569 127.993 328.946 127.222 329.63 125.679V114.15H332.34V130H329.762L329.703 128.433ZM342.828 128.081C343.795 128.081 344.64 127.788 345.362 127.202C346.085 126.616 346.485 125.884 346.563 125.005H349.127C349.078 125.913 348.766 126.777 348.189 127.598C347.613 128.418 346.842 129.072 345.875 129.561C344.918 130.049 343.902 130.293 342.828 130.293C340.67 130.293 338.951 129.575 337.672 128.14C336.402 126.694 335.768 124.722 335.768 122.222V121.768C335.768 120.225 336.051 118.853 336.617 117.651C337.184 116.45 337.994 115.518 339.049 114.854C340.113 114.189 341.368 113.857 342.813 113.857C344.591 113.857 346.065 114.39 347.237 115.454C348.419 116.519 349.049 117.9 349.127 119.6H346.563C346.485 118.574 346.095 117.734 345.392 117.08C344.698 116.416 343.839 116.084 342.813 116.084C341.437 116.084 340.367 116.582 339.605 117.578C338.854 118.564 338.478 119.995 338.478 121.87V122.383C338.478 124.209 338.854 125.615 339.605 126.602C340.357 127.588 341.432 128.081 342.828 128.081ZM355.851 110.312V114.15H358.81V116.245H355.851V126.074C355.851 126.709 355.982 127.188 356.246 127.51C356.51 127.822 356.959 127.979 357.594 127.979C357.906 127.979 358.336 127.92 358.883 127.803V130C358.17 130.195 357.477 130.293 356.803 130.293C355.592 130.293 354.679 129.927 354.063 129.194C353.448 128.462 353.141 127.422 353.141 126.074V116.245H350.255V114.15H353.141V110.312H355.851Z" fill="white"/>
        <circle cx="261" cy="52" r="51" stroke="white" stroke-width="2"/>
        <path d="M273.838 31.878V46.5122L268.432 41.6341L263.027 46.5122V31.878H252.216V70.9024H260.595C260.865 72.6098 261.676 74.3171 262.486 75.7805H246.811C243.838 75.7805 241.405 73.3415 241.405 70.9024V68.4634H236V63.5854H241.405V53.8293H236V48.9512H241.405V39.1951H236V34.3171H241.405V31.878C241.405 29.1951 243.838 27 246.811 27H279.243C281.946 27 284.649 29.439 284.649 31.878V55.7805C283.027 54.8049 281.135 54.3171 279.243 54.0732V31.878H273.838ZM241.405 68.4634H246.811V63.5854H241.405V68.4634ZM241.405 53.8293H246.811V48.9512H241.405V53.8293ZM241.405 39.1951H246.811V34.3171H241.405V39.1951ZM282.216 59.9268L276.541 65.0488L270.865 59.9268L267.081 63.3415L272.757 68.4634L267.081 73.5854L270.865 77L276.541 71.878L282.216 77L286 73.5854L280.324 68.4634L286 63.3415L282.216 59.9268Z" fill="white"/>
        </svg>

        <div id="ProductOptionsDelete" class="p-3 form-input d-flex flex-column align-items-start m-auto rounded" style="width: 75%;height: 30vh;">
        </div>
        <b-button id="buttonDeleteProductModal" class="mt-3" block variant="outline-warning">Delete</b-button>
    </div>
  </div>
</template>

<script>
import { ProductApi } from "../service/compiled/product/ProductApi"
let productApi = new ProductApi(); 
var pageNumberProduct = 0;
    export default{
        methods: {
            closeModalDeleteProduct(){
                this.$emit('click');
            },

            setProductsOnVue(pageNumber) {
            let element = document.getElementById("ProductOptionsDelete");
            let html = element.innerHTML;
            fetch(`http://localhost:8080/api/book/find/find-all-available/${pageNumber}`, {
                method: 'GET',
                headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                "Authorization": `Bearer ${window.localStorage.getItem("token")}`
                }
            }).then(async function(apiResponse) {
                let json = await apiResponse.json();
                let count = 0;
                while (json[count] !== undefined) {
                    html = html + `<span><input type="checkbox" value="${json[count]["id"]}" id="productCheckedBoxDelete"> (ID-${json[count]["id"]})              ${json[count]["title"]}</span>`
                    count++;
                }
                element.innerHTML = html;
            });
        },

         productScrollPage() {
            let productOp = document.getElementById("ProductOptionsDelete");
            productOp.addEventListener("scroll", () => {
                if(productOp.scrollTop + productOp.clientHeight == productOp.scrollHeight) {
                    pageNumberProduct++;
                    this.setProductsOnVue(pageNumberProduct);
                }
            })
        }
        },

        mounted() {
            this.setProductsOnVue(0);
            this.productScrollPage();
            productApi.deleteProductListener();
        },
    }
</script>

<style scoped>
    .font-red {
        color: red;
    }

    .form-input {
        color: white;
        border: 1px solid white;
    }

    .boxextern {
        width: 100vw;
        height: 100vh; 
        background: rgba(0, 0, 0,.5);
        position: fixed;
        top: 0px;
        left: 0px;
        z-index: 2000;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .boxintern {
        background: linear-gradient(138.08deg, #531A7B -13.53%, rgba(110, 38, 161, 0.66) 54.75%, rgba(149, 57, 213, 0.46) 111.81%, rgba(161, 60, 232, 0) 165.13%), #FFFFFF;;
        width: 40%;
        min-width: 300px;
        max-height: 500px;
        padding: 20px;
        border-radius: 8px;
        position: relative;
    }

    .closed {
        background: transparent;
        position: absolute;
        top: 0px;
        right: 0px;
        width: 50px;
        height: 50px;
        border: none;
        cursor: pointer;
        font-size: 1.4em;
    }

    .divider-menu {
        border: 1px solid rgb(255, 255, 255);
        width: 100%;
    }

    #CategoryOptions{
        overflow-x: hidden;
        overflow-y: auto;
    }
</style>