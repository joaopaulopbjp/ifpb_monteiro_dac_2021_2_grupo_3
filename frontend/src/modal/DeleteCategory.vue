<template>
  <div id="" class="boxextern">
    <div class=" boxintern text-center p-5">
      <button id="closeButtonCategoryDelete" class="closed" @click="closeModalDeleteCategory()">x</button>
      
      <svg width="80%" class="mb-3" viewBox="0 0 528 137" fill="none" xmlns="http://www.w3.org/2000/svg">
      <line x1="398" y1="118" x2="528" y2="118" stroke="white" stroke-width="2"/>
      <line y1="118" x2="130" y2="118" stroke="white" stroke-width="2"/>
      <path d="M157.906 130V108.672H163.927C165.782 108.672 167.423 109.082 168.849 109.902C170.274 110.723 171.373 111.89 172.145 113.403C172.926 114.917 173.321 116.655 173.331 118.618V119.98C173.331 121.992 172.94 123.755 172.159 125.269C171.388 126.782 170.279 127.944 168.834 128.755C167.398 129.565 165.724 129.98 163.81 130H157.906ZM160.719 110.986V127.7H163.678C165.846 127.7 167.53 127.026 168.731 125.679C169.942 124.331 170.548 122.412 170.548 119.922V118.677C170.548 116.255 169.977 114.375 168.834 113.037C167.701 111.689 166.09 111.006 164 110.986H160.719ZM183.746 130.293C181.598 130.293 179.85 129.59 178.502 128.184C177.154 126.768 176.48 124.878 176.48 122.515V122.017C176.48 120.444 176.778 119.043 177.374 117.812C177.979 116.572 178.819 115.605 179.894 114.912C180.978 114.209 182.149 113.857 183.409 113.857C185.47 113.857 187.071 114.536 188.214 115.894C189.356 117.251 189.928 119.194 189.928 121.724V122.852H179.19C179.229 124.414 179.684 125.679 180.553 126.646C181.432 127.603 182.545 128.081 183.893 128.081C184.85 128.081 185.66 127.886 186.324 127.495C186.988 127.104 187.569 126.587 188.067 125.942L189.723 127.231C188.395 129.272 186.402 130.293 183.746 130.293ZM183.409 116.084C182.315 116.084 181.397 116.484 180.655 117.285C179.913 118.076 179.454 119.189 179.278 120.625H187.218V120.42C187.14 119.043 186.769 117.979 186.104 117.227C185.44 116.465 184.542 116.084 183.409 116.084ZM196.021 130H193.312V107.5H196.021V130ZM206.949 130.293C204.801 130.293 203.053 129.59 201.705 128.184C200.357 126.768 199.684 124.878 199.684 122.515V122.017C199.684 120.444 199.981 119.043 200.577 117.812C201.183 116.572 202.022 115.605 203.097 114.912C204.181 114.209 205.353 113.857 206.612 113.857C208.673 113.857 210.274 114.536 211.417 115.894C212.56 117.251 213.131 119.194 213.131 121.724V122.852H202.394C202.433 124.414 202.887 125.679 203.756 126.646C204.635 127.603 205.748 128.081 207.096 128.081C208.053 128.081 208.863 127.886 209.527 127.495C210.191 127.104 210.772 126.587 211.271 125.942L212.926 127.231C211.598 129.272 209.605 130.293 206.949 130.293ZM206.612 116.084C205.519 116.084 204.601 116.484 203.858 117.285C203.116 118.076 202.657 119.189 202.481 120.625H210.421V120.42C210.343 119.043 209.972 117.979 209.308 117.227C208.644 116.465 207.745 116.084 206.612 116.084ZM219.957 110.312V114.15H222.916V116.245H219.957V126.074C219.957 126.709 220.089 127.188 220.353 127.51C220.616 127.822 221.065 127.979 221.7 127.979C222.013 127.979 222.442 127.92 222.989 127.803V130C222.276 130.195 221.583 130.293 220.909 130.293C219.698 130.293 218.785 129.927 218.17 129.194C217.555 128.462 217.247 127.422 217.247 126.074V116.245H214.361V114.15H217.247V110.312H219.957ZM232.672 130.293C230.523 130.293 228.775 129.59 227.428 128.184C226.08 126.768 225.406 124.878 225.406 122.515V122.017C225.406 120.444 225.704 119.043 226.3 117.812C226.905 116.572 227.745 115.605 228.819 114.912C229.903 114.209 231.075 113.857 232.335 113.857C234.396 113.857 235.997 114.536 237.14 115.894C238.282 117.251 238.854 119.194 238.854 121.724V122.852H228.116C228.155 124.414 228.609 125.679 229.479 126.646C230.357 127.603 231.471 128.081 232.818 128.081C233.775 128.081 234.586 127.886 235.25 127.495C235.914 127.104 236.495 126.587 236.993 125.942L238.648 127.231C237.32 129.272 235.328 130.293 232.672 130.293ZM232.335 116.084C231.241 116.084 230.323 116.484 229.581 117.285C228.839 118.076 228.38 119.189 228.204 120.625H236.144V120.42C236.065 119.043 235.694 117.979 235.03 117.227C234.366 116.465 233.468 116.084 232.335 116.084ZM265.558 123.232C265.294 125.488 264.459 127.231 263.053 128.462C261.656 129.683 259.796 130.293 257.472 130.293C254.952 130.293 252.931 129.39 251.407 127.583C249.894 125.776 249.137 123.359 249.137 120.332V118.281C249.137 116.299 249.488 114.556 250.191 113.052C250.904 111.548 251.91 110.396 253.209 109.595C254.508 108.784 256.012 108.379 257.721 108.379C259.986 108.379 261.803 109.014 263.17 110.283C264.537 111.543 265.333 113.291 265.558 115.527H262.73C262.486 113.828 261.954 112.598 261.134 111.836C260.323 111.074 259.186 110.693 257.721 110.693C255.924 110.693 254.513 111.357 253.487 112.686C252.472 114.014 251.964 115.903 251.964 118.354V120.42C251.964 122.734 252.447 124.575 253.414 125.942C254.381 127.31 255.733 127.993 257.472 127.993C259.034 127.993 260.23 127.642 261.061 126.938C261.9 126.226 262.457 124.99 262.73 123.232H265.558ZM278.771 130C278.614 129.688 278.487 129.131 278.39 128.33C277.13 129.639 275.626 130.293 273.878 130.293C272.315 130.293 271.031 129.854 270.025 128.975C269.029 128.086 268.531 126.963 268.531 125.605C268.531 123.955 269.156 122.676 270.406 121.768C271.666 120.85 273.434 120.391 275.709 120.391H278.346V119.146C278.346 118.198 278.062 117.446 277.496 116.89C276.93 116.323 276.095 116.04 274.991 116.04C274.024 116.04 273.214 116.284 272.56 116.772C271.905 117.261 271.578 117.852 271.578 118.545H268.854C268.854 117.754 269.132 116.992 269.688 116.26C270.255 115.518 271.017 114.932 271.974 114.502C272.94 114.072 274 113.857 275.152 113.857C276.979 113.857 278.409 114.316 279.444 115.234C280.479 116.143 281.017 117.397 281.056 118.999V126.294C281.056 127.749 281.241 128.906 281.612 129.766V130H278.771ZM274.273 127.935C275.123 127.935 275.929 127.715 276.69 127.275C277.452 126.836 278.004 126.265 278.346 125.562V122.31H276.222C272.901 122.31 271.241 123.281 271.241 125.225C271.241 126.074 271.524 126.738 272.091 127.217C272.657 127.695 273.385 127.935 274.273 127.935ZM288.98 110.312V114.15H291.939V116.245H288.98V126.074C288.98 126.709 289.112 127.188 289.376 127.51C289.64 127.822 290.089 127.979 290.724 127.979C291.036 127.979 291.466 127.92 292.013 127.803V130C291.3 130.195 290.606 130.293 289.933 130.293C288.722 130.293 287.809 129.927 287.193 129.194C286.578 128.462 286.271 127.422 286.271 126.074V116.245H283.385V114.15H286.271V110.312H288.98ZM301.695 130.293C299.547 130.293 297.799 129.59 296.451 128.184C295.104 126.768 294.43 124.878 294.43 122.515V122.017C294.43 120.444 294.728 119.043 295.323 117.812C295.929 116.572 296.769 115.605 297.843 114.912C298.927 114.209 300.099 113.857 301.358 113.857C303.419 113.857 305.021 114.536 306.163 115.894C307.306 117.251 307.877 119.194 307.877 121.724V122.852H297.14C297.179 124.414 297.633 125.679 298.502 126.646C299.381 127.603 300.494 128.081 301.842 128.081C302.799 128.081 303.609 127.886 304.273 127.495C304.938 127.104 305.519 126.587 306.017 125.942L307.672 127.231C306.344 129.272 304.352 130.293 301.695 130.293ZM301.358 116.084C300.265 116.084 299.347 116.484 298.604 117.285C297.862 118.076 297.403 119.189 297.228 120.625H305.167V120.42C305.089 119.043 304.718 117.979 304.054 117.227C303.39 116.465 302.491 116.084 301.358 116.084ZM310.382 121.943C310.382 119.473 310.953 117.51 312.096 116.055C313.238 114.59 314.752 113.857 316.637 113.857C318.57 113.857 320.079 114.541 321.163 115.908L321.295 114.15H323.771V129.619C323.771 131.67 323.16 133.286 321.939 134.468C320.729 135.649 319.098 136.24 317.047 136.24C315.904 136.24 314.786 135.996 313.692 135.508C312.599 135.02 311.764 134.351 311.188 133.501L312.594 131.875C313.756 133.311 315.177 134.028 316.856 134.028C318.175 134.028 319.2 133.657 319.933 132.915C320.675 132.173 321.046 131.128 321.046 129.78V128.418C319.962 129.668 318.482 130.293 316.607 130.293C314.752 130.293 313.248 129.546 312.096 128.052C310.953 126.558 310.382 124.521 310.382 121.943ZM313.106 122.251C313.106 124.038 313.473 125.444 314.205 126.47C314.938 127.485 315.963 127.993 317.281 127.993C318.99 127.993 320.245 127.217 321.046 125.664V118.428C320.216 116.914 318.971 116.157 317.311 116.157C315.992 116.157 314.962 116.67 314.22 117.695C313.478 118.721 313.106 120.239 313.106 122.251ZM327.154 121.929C327.154 120.376 327.457 118.979 328.062 117.739C328.678 116.499 329.527 115.542 330.611 114.868C331.705 114.194 332.95 113.857 334.347 113.857C336.505 113.857 338.248 114.604 339.576 116.099C340.914 117.593 341.583 119.58 341.583 122.061V122.251C341.583 123.794 341.285 125.181 340.689 126.411C340.104 127.632 339.259 128.584 338.155 129.268C337.062 129.951 335.802 130.293 334.376 130.293C332.228 130.293 330.484 129.546 329.146 128.052C327.818 126.558 327.154 124.58 327.154 122.119V121.929ZM329.879 122.251C329.879 124.009 330.284 125.42 331.095 126.484C331.915 127.549 333.009 128.081 334.376 128.081C335.753 128.081 336.847 127.544 337.657 126.47C338.468 125.386 338.873 123.872 338.873 121.929C338.873 120.19 338.458 118.784 337.628 117.71C336.808 116.626 335.714 116.084 334.347 116.084C333.009 116.084 331.93 116.616 331.109 117.681C330.289 118.745 329.879 120.269 329.879 122.251ZM352.643 116.582C352.232 116.514 351.788 116.479 351.31 116.479C349.532 116.479 348.326 117.236 347.691 118.75V130H344.981V114.15H347.618L347.662 115.981C348.551 114.565 349.811 113.857 351.441 113.857C351.969 113.857 352.369 113.926 352.643 114.062V116.582ZM360.597 126.03L364.288 114.15H367.188L360.816 132.446C359.83 135.083 358.263 136.401 356.114 136.401L355.602 136.357L354.591 136.167V133.97L355.323 134.028C356.241 134.028 356.954 133.843 357.462 133.472C357.979 133.101 358.404 132.422 358.736 131.436L359.337 129.824L353.683 114.15H356.642L360.597 126.03Z" fill="white"/>
      <circle cx="261" cy="52" r="51" stroke="white" stroke-width="2"/>
      <path d="M257.053 55.75V75.75H236V55.75H257.053ZM251.789 60.75H241.263V70.75H251.789V60.75ZM259.684 27L274.158 49.5H245.211L259.684 27ZM259.684 36.65L254.632 44.5H264.737L259.684 36.65ZM274.158 54.5C280.737 54.5 286 59.5 286 65.75C286 72 280.737 77 274.158 77C267.579 77 262.316 72 262.316 65.75C262.316 59.5 267.579 54.5 274.158 54.5ZM274.158 59.5C272.413 59.5 270.74 60.1585 269.506 61.3306C268.272 62.5027 267.579 64.0924 267.579 65.75C267.579 67.4076 268.272 68.9973 269.506 70.1694C270.74 71.3415 272.413 72 274.158 72C275.903 72 277.576 71.3415 278.81 70.1694C280.044 68.9973 280.737 67.4076 280.737 65.75C280.737 64.0924 280.044 62.5027 278.81 61.3306C277.576 60.1585 275.903 59.5 274.158 59.5Z" fill="white"/>
      </svg>

      
      <div id="categoryOptions" class="p-3 form-input d-flex flex-column align-items-start m-auto rounded" style="width: 60%;height: 30vh;">
      </div>
      <b-button id="buttonDeleteCategoryModal" class="mt-3" block variant="outline-warning">Delete</b-button>
    </div>
  </div>
</template>

<script>
import { CategoryService } from "../service/compiled/category/CategoryService"
let categoryService = new CategoryService();
var pageNumberCategories = 0;
  export default{
    methods:{
      closeModalDeleteCategory(){
        this.$emit('click');
      },
       setCategoriesOnVue(pageNumber) {
            let element = document.getElementById("categoryOptions");
            let html = element.innerHTML;
            fetch(`http://localhost:8080/api/category/find/find-all/${pageNumber}`, {
                method: 'GET',
                headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                "Authorization": `Bearer ${window.localStorage.getItem("token")}`
                }
            }).then(async function(apiResponse) {
                let json = await apiResponse.json();
                let count = 0;
                while (json[count] !== undefined) {
                    html = html + `<span><input type="checkbox" value="${json[count]["id"]}" id="categoryCheckedBoxDelete"> ${json[count]["name"]}</span>`
                    count++;
                }
                element.innerHTML = html;
            });
        },
         categoryScrollPage() {
            let categoryOp = document.getElementById("categoryOptions");
            categoryOp.addEventListener("scroll", () => {
                if(categoryOp.scrollTop + categoryOp.clientHeight == categoryOp.scrollHeight) {
                    pageNumberCategories++;
                    this.setCategoriesOnVue(pageNumberCategories);
                }
            })
        }
    },
    
    mounted() {
        this.setCategoriesOnVue(0);
        this.categoryScrollPage();
        categoryService.deleteCategoryListener();
    }
  };
</script>

<style scoped>

.font-red {
  color: red;
}

.form-input {
  color: white;
  border: 1px solid white;
}

.boxextern {
  width: 100vw;
  height: 100vh; 
  background: rgba(0, 0, 0,.5);
  position: fixed;
  top: 0px;
  left: 0px;
  z-index: 2000;
  display: flex;
  justify-content: center;
  align-items: center;
}

.boxintern {
  background: linear-gradient(138.08deg, #531A7B -13.53%, rgba(110, 38, 161, 0.66) 54.75%, rgba(149, 57, 213, 0.46) 111.81%, rgba(161, 60, 232, 0) 165.13%), #FFFFFF;;
  width: 40%;
  min-width: 300px;
  max-height: 500px;
  padding: 20px;
  border-radius: 8px;
  position: relative;
}

.closed {
  background: transparent;
  position: absolute;
  top: 0px;
  right: 0px;
  width: 50px;
  height: 50px;
  border: none;
  cursor: pointer;
  font-size: 1.4em;
}

.divider-menu {
    border: 1px solid rgb(255, 255, 255);
    width: 100%;
}

#CategoryOptions{
  overflow-x: hidden;
  overflow-y: auto;
}

</style>